# FruitsParkOfficialApp

## フルーツ公園公式アプリ　マップアプリ

iOS版：https://apps.apple.com/jp/app/fruitparkofficialapp/id6743319556

Android版：https://play.google.com/store/apps/details?id=com.DefaultCompany.FruitParkOfficialApp&hl=ja


**開発期間**：2023年〜2024年

**開発環境**：Unity（C#）／AWS（S3, Lambda, DynamoDB,LightSail）, GitLab, CloudFlare, Docker, Directus

**対象施設**：山梨県笛吹市フルーツパーク

---

### ■ 開発の背景と目的

### 公園側の課題認識

フルーツパークは、果実が実る**夏季に来園者が集中し、冬季には利用者数が大きく減少**するという季節依存の課題を抱えていました。

また、園内には**来客がほとんどないエリア**も存在し、その有効活用が求められていました。

そこで、公園側は**季節を問わず楽しめるアクティビティ**の導入を検討しており、その一環として本プロジェクトがスタートしました。

### 開発チーム側の課題意識

アプリを一度遊んでもらうだけでは、通年での来園促進という根本的な課題解決にはつながらないと考えました。

そのため、単発の体験ではなく、**継続的に遊べるリピート型の設計**を重視しました。

具体的には、

- **RPG形式の育成ゲーム要素**を組み込み、データを持ち越して遊べる仕組みを導入。
- 園内全体を活性化するために、**マップアプリの自作開発を提案**し、地図上からスポットを探索できるAR体験を設計しました。

---

### ■ 技術的工夫点

### 1. **外部ライブラリ不使用の完全独自マップ実装**

Google Maps 等のライブラリやアセットを一切使わず、**Unity上でゼロからマップ機能を構築**。

- スワイプ／ピンチイン／ピンチアウトなどの操作をすべて自前で実装。
- イベント駆動構成とすることで `Update()` 処理を廃止し、入力遅延や画面ブレを解消。
- 操作応答性を最適化し、**Google Mapsに匹敵する操作感**を実現。

### 2. **緯度経度を用いた独自座標変換**

- 公園全体を仮想的な正方形領域として設定し、緯度経度の最小値・最大値をもとに**比率計算で位置を算出**。
- 割合値にUnity上のマップサイズを掛け合わせることで、スポットPinや現在地を正確に描画。
- API非依存の**完全自律マップシステム**を実現。

### 3. **非同期処理とオフライン対応**

- スポット詳細情報を**非同期（async）処理で逐次取得・描画**し、遅延のない操作体験を維持。
- 園内の通信環境が不安定なため、**オフラインモードを実装**し、キャッシュされた情報で動作を継続可能に。

### 4. **Lerp補間による滑らかな挙動**

- 位置・ズーム・回転などの動作をLerp（線形補間）で制御し、**カクつきや跳ねを排除**。
- スクロールやズーム時の自然な慣性を再現。

### 5. **センサーデータの安定化**

- GPS・地磁気センサーを用いた現在地推定では、ノイズによる「方向の反転」「瞬間移動」などの誤差が発生。
- Lerp補間と過去値の平滑化を組み合わせて誤差を吸収し、**Google Mapsと遜色ない安定追従性**を確保。

### 6. **アプリ内ブラウザ（WebView）の実装**

- 公園利用者の「外部ブラウザに飛ぶのが不便」という意見を受け、アプリ内にWebViewを統合。
- 交通情報・イベント情報をアプリ内でシームレスに閲覧可能にした。

### 7. **ズーム倍率に応じた動的スケーリング**

- カメラのField of View（FOV）に基づき、ズーム倍率に応じてスワイプ感度・Pinサイズを**比率制御**。
- ズーム時もUIサイズが変わらず、違和感のない視覚体験を実現。

---

### ■ 成果・学び

- 外部マップAPIに頼らず、**地図アプリの基本機能を一から再現**することの難しさと、操作体験を滑らかに保つ設計の重要性を実感。
- 外部マップAPIに頼らないことで、API料金の削減による維持費の低コスト化、アプリの世界観に合わせたマップ画像を使用し、UXを向上させました。
- 入力イベント制御・座標変換・非同期通信・補間処理を統合的に最適化することで、Unityでも**商用レベルのマップ体験**を実現できることを証明。
- 本経験を通じて、UI/UX設計、非同期処理、センサーデータ補正など、**リアルタイムアプリ開発に必須の技術基盤**を獲得した。

<img width="231" height="500" alt="IMG_8582" src="https://github.com/user-attachments/assets/5e360f84-5218-485d-bd7a-59f6bdfea42b" />
<img width="231" height="500" alt="IMG_8581" src="https://github.com/user-attachments/assets/77c57209-80aa-4b7a-9594-91750fbe5387" />
<img width="231" height="500" alt="IMG_8580" src="https://github.com/user-attachments/assets/c4c20a81-3528-46e9-9186-27d08c1036dc" />
<img width="231" height="500" alt="IMG_8579" src="https://github.com/user-attachments/assets/6c0a589c-a046-4798-bdd4-31519fda890c" />


https://github.com/user-attachments/assets/19ea59c9-7c07-4c98-a81e-f221a129680b

